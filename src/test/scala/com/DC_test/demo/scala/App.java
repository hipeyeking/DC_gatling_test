package com.DC_test.demo.scala;

import java.util.Map;
import java.util.zip.GZIPInputStream;
import java.util.zip.GZIPOutputStream;
import java.io.File;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream ;
import java.io.EOFException;

import com.fasterxml.jackson.databind.ObjectMapper;

import org.apache.http.client.fluent.Request;
import org.apache.http.entity.ContentType;
import org.apache.avro.Schema;
import org.apache.avro.io.DecoderFactory;
import org.apache.avro.io.Decoder;
import org.apache.avro.io.EncoderFactory;
import org.apache.avro.io.Encoder;

import org.apache.avro.generic.GenericDatumReader;
import org.apache.avro.generic.GenericDatumWriter;

// import org.mihkel.avro.io.ExtendedJsonDecoder ;
//import org.apache.avro.io.ExtendedJsonDecoder ;

import java.util.Base64;
import org.apache.avro.Protocol;
import java.util.Collection;

public class App {
    public  byte[] jsonToAvroBin(String schema_str, String json) throws Exception {
        System.out.println("hello world!") ;
        ByteArrayOutputStream os = new ByteArrayOutputStream();
        Schema schema = new Schema.Parser().parse(schema_str);
        // Decoder jsonDecoder = DecoderFactory.get().jsonDecoder(schema, json);
        Decoder jsonDecoder = new ExtendedJsonDecoder(schema, json);
        Encoder binEncoder = EncoderFactory.get().binaryEncoder(os, null);

        GenericDatumReader<Object> reader = new GenericDatumReader<Object>(schema);
        GenericDatumWriter<Object> writer = new GenericDatumWriter<Object>(schema);
        Object datum = null;
        while (true) {
            try {
                datum = reader.read(datum, jsonDecoder);
            } catch (EOFException eofException) {
                break;
            }
            writer.write(datum, binEncoder);
            binEncoder.flush();
        }
        return os.toByteArray();
    }

    public static byte[] gzip(byte[] avro_bin) throws Exception {
        ByteArrayOutputStream os = new ByteArrayOutputStream();
        GZIPOutputStream gz = new GZIPOutputStream(os);
        gz.write(avro_bin);
        gz.close();
        return os.toByteArray() ;
    }
    public static void main(String[] args) throws Exception {

        // 1. request token
//        String token_str = Request.Post("https://apex-dc-api-test.chinapex.com.cn/signature/password_token")
//                .bodyString("{\"app_id\": \"18e94303355ed4e7fe20f928cb663f99c7de0905\", \"app_secret\": \"ec49291da062b806d721d18c1c735ea900d1f66b\"}", ContentType.APPLICATION_JSON)
//                .execute()
//                .returnContent()
//                .asString();
//
//        Map<String, Object> token_json = new ObjectMapper().readValue(token_str, Map.class);
//        String access_token = (String) ((Map<String, Object>) token_json.get("result")).get("access_token");
//        System.out.println("access_token:" + access_token);
//

        // 2. push data

//        Schema schema = Protocol.parse(new File("avsc/data_buffer.avsc")).getType(args[0]);
//        System.err.println(schema);
        


//        String schema_str = "{\"type\":\"array\",\"name\":\"bulk\",\"items\":[{\"type\":\"record\",\"name\":\"android\",\"namespace\":\"android\",\"fields\":[{\"name\":\"common\",\"type\":{\"name\":\"common_record\",\"type\":\"record\",\"fields\":[{\"name\":\"message_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"project_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"app_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"tenant_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"upload_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"Apex_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"session_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"app_version\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"app_package_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"carrier\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"mini_program_scene\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"sdk_info\",\"type\":{\"type\":\"record\",\"name\":\"sdk_info_record\",\"fields\":[{\"name\":\"sdk_version\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"sdk_type\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"device_info\",\"type\":{\"type\":\"record\",\"name\":\"device_info_record\",\"fields\":[{\"name\":\"device_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_model\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_brand\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_uuid\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"android_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"imei\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"mac\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"user_agent\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"idfa\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"idfv\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"oaid\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"screen\",\"type\":{\"type\":\"record\",\"name\":\"screen_record\",\"fields\":[{\"name\":\"screen_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"screen_width\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"os\",\"type\":{\"type\":\"record\",\"name\":\"os_record\",\"fields\":[{\"name\":\"os_system\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"os_version\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"browser\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"browser_record\",\"fields\":[{\"name\":\"browser_type\",\"type\":[\"null\", \"string\"],\"default\":null},{\"name\":\"browser_version\",\"type\":[\"null\",\"string\"],\"default\":null}]}],\"default\":null},{\"name\":\"wechat\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"wechat_record\",\"fields\":[{\"name\":\"wechat_open_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"wechat_union_id\",\"type\":[\"null\",\"string\"],\"default\":null}]}],\"default\":null},{\"name\":\"referrer_info\",\"type\":{\"type\":\"record\",\"name\":\"referrer_info_record\",\"fields\":[{\"name\":\"referrer_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"referrer_host\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"market_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_info\",\"type\":{\"type\":\"record\",\"name\":\"utm_info_record\",\"fields\":[{\"name\":\"utm_matching_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_source\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_medium\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_term\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_campaign\",\"type\":[\"null\",\"string\"],\"default\":null}]}}]}},{\"name\":\"events\",\"type\":{\"type\":\"array\",\"name\":\"events_item\",\"items\":[{\"name\":\"click\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info1\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record1\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record1\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record1\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record1\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record1\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"view_page\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info2\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record2\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record2\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record2\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record2\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record2\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"custom\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info3\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record3\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record3\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record3\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record3\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record3\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"cold_start\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info4\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record4\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record4\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record4\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record4\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record4\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"hot_start\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info5\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record5\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record5\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record5\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record5\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record5\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"use_end\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info6\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record6\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record6\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record6\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record6\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record6\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]}]}}]}]}" ;
//        String data_str = "[{\"android.android\":{\"common\":{\"Apex_id\":\"fb59284c-f546-3e23-80f4-04157bebe98c\",\"app_id\":\"ssssss\",\"app_package_id\":\"com.chinapex.analytics.sample\",\"app_version\":\"1.7\",\"browser\":{\"browser_type\":null,\"browser_version\":null},\"carrier\":\"\",\"device_info\":{\"android_id\":\"3b201a0d92467a28\",\"device_brand\":\"HUAWEI\",\"device_id\":\"\",\"device_model\":\"CDY-AN00\",\"device_type\":\"phone\",\"device_uuid\":\"fb59284c-f546-3e23-80f4-04157bebe98c\",\"idfa\":\"\",\"idfv\":\"\",\"mac\":\"02:00:00:00:00:00\",\"oaid\":\"\",\"user_agent\":\"Mozilla/5.0 (Linux; Android 10; CDY-AN00 Build/HUAWEICDY-AN00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.108 Mobile Safari/537.36\"},\"market_name\":\"豌豆荚\",\"message_id\":\"1\",\"mini_program_scene\":\"\",\"os\":{\"os_system\":\"Android\",\"os_version\":\"10\"},\"project_id\":\"\",\"referrer_info\":{\"referrer_host\":\"\",\"referrer_url\":\"\"},\"screen\":{\"screen_height\":\"2292\",\"screen_width\":\"1080\"},\"sdk_info\":{\"sdk_type\":\"Android\",\"sdk_version\":\"1.0.8\"},\"session_id\":\"session_1598507904750\",\"tenant_id\":\"\",\"upload_time\":\"\",\"utm_info\":{\"utm_campaign\":\"\",\"utm_content\":\"\",\"utm_matching_type\":\"\",\"utm_medium\":\"\",\"utm_source\":\"\",\"utm_term\":\"\"}},\"events\":[{\"android.click\":{\"browse_time\":\"\",\"business_info\":{\"extentions\":{},\"user_id\":\"\"},\"coordinate_info\":{\"client_X\":\"\",\"client_Y\":\"\",\"page_X\":\"\",\"page_Y\":\"\"},\"element_info\":{\"element_class\":\"\",\"element_content\":\"\",\"element_id\":\"\",\"element_index\":\"\",\"element_name\":\"\",\"element_path\":\"com.chinapex.analytics.sample.activity.MainActivity\",\"element_position\":\"\",\"element_selector\":\"\",\"element_tag_name\":\"\",\"element_target_url\":\"\",\"element_type\":\"\"},\"event_code\":\"com.chinapex.analytics.sample.activity.MainActivity\",\"event_code_md5\":\"22780252a4d40167824e7595c52cd0b0\",\"event_duration\":\"\",\"event_name\":\"发送即时事件\",\"event_type\":\"click\",\"location_info\":{\"city\":\"\",\"city_id\":\"\",\"country\":\"\",\"county\":\"\",\"ip\":\"192.168.0.98\",\"latitude\":\"\",\"longitude\":\"\",\"province\":\"\",\"province_id\":\"\"},\"page_info\":{\"current_page_host\":\"\",\"current_page_id\":\"com.chinapex.analytics.sample.activity.MainActivity\",\"current_page_name\":\"com.chinapex.analytics.sample.activity.MainActivity\",\"current_page_path\":\"\",\"current_page_query\":\"\",\"current_page_url\":\"\",\"source_page_host\":\"\",\"source_page_id\":\"com.chinapex.analytics.sample.activity.LaunchActivity\",\"source_page_name\":\"\",\"source_page_path\":\"com.chinapex.analytics.sample.activity.LaunchActivity\",\"source_page_query\":\"\",\"source_page_url\":\"\"},\"page_type\":\"android\",\"send_type\":\"all\",\"size_info\":{\"page_height\":\"\",\"page_width\":\"\",\"visible_window_height\":\"\",\"visible_window_width\":\"\"},\"time_since_last_operation\":\"\",\"ts\":\"1598507913747\"}}]}}]" ;

        String schema_str = "{\"type\":\"array\",\"items\":[{\"type\":\"record\",\"name\":\"web\",\"namespace\":\"web\",\"fields\":[{\"name\":\"common\",\"type\":{\"name\":\"common_record_web\",\"type\":\"record\",\"fields\":[{\"name\":\"message_id\",\"type\":\"string\"},{\"name\":\"project_id\",\"type\":\"string\"},{\"name\":\"app_id\",\"type\":\"string\"},{\"name\":\"tenant_id\",\"type\":\"string\"},{\"name\":\"upload_time\",\"type\":\"long\"},{\"name\":\"Apex_id\",\"type\":\"string\"},{\"name\":\"session_id\",\"type\":\"string\"},{\"name\":\"app_version\",\"type\":\"string\"},{\"name\":\"app_package_id\",\"type\":\"string\"},{\"name\":\"carrier\",\"type\":\"string\"},{\"name\":\"mini_program_scene\",\"type\":\"string\"},{\"name\":\"sdk_info\",\"type\":{\"type\":\"record\",\"name\":\"sdk_info_record\",\"fields\":[{\"name\":\"sdk_version\",\"type\":\"string\"},{\"name\":\"sdk_type\",\"type\":\"string\"}]}},{\"name\":\"device_info\",\"type\":{\"type\":\"record\",\"name\":\"device_info_record\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\"},{\"name\":\"device_model\",\"type\":\"string\"},{\"name\":\"device_brand\",\"type\":\"string\"},{\"name\":\"device_type\",\"type\":\"string\"},{\"name\":\"device_uuid\",\"type\":\"string\"},{\"name\":\"android_id\",\"type\":\"string\"},{\"name\":\"imei\",\"type\":\"string\"},{\"name\":\"mac\",\"type\":\"string\"},{\"name\":\"user_agent\",\"type\":\"string\"},{\"name\":\"idfa\",\"type\":\"string\"},{\"name\":\"idfv\",\"type\":\"string\"},{\"name\":\"oaid\",\"type\":\"string\"}]}},{\"name\":\"screen\",\"type\":{\"type\":\"record\",\"name\":\"screen_record\",\"fields\":[{\"name\":\"screen_height\",\"type\":[\"null\",\"float\"]},{\"name\":\"screen_width\",\"type\":[\"null\",\"float\"]}]}},{\"name\":\"os\",\"type\":{\"type\":\"record\",\"name\":\"os_record\",\"fields\":[{\"name\":\"os_system\",\"type\":\"string\"},{\"name\":\"os_version\",\"type\":\"string\"}]}},{\"name\":\"browser\",\"type\":{\"type\":\"record\",\"name\":\"browser_record\",\"fields\":[{\"name\":\"browser_type\",\"type\":\"string\"},{\"name\":\"browser_version\",\"type\":\"string\"}]}},{\"name\":\"wechat\",\"type\":{\"type\":\"record\",\"name\":\"wechat_record\",\"fields\":[{\"name\":\"wechat_open_id\",\"type\":\"string\"},{\"name\":\"wechat_union_id\",\"type\":\"string\"}]}},{\"name\":\"referrer_info\",\"type\":{\"type\":\"record\",\"name\":\"referrer_info_record\",\"fields\":[{\"name\":\"referrer_url\",\"type\":\"string\"},{\"name\":\"referrer_host\",\"type\":\"string\"}]}},{\"name\":\"market_name\",\"type\":\"string\"},{\"name\":\"utm_info\",\"type\":{\"type\":\"record\",\"name\":\"utm_info_record\",\"fields\":[{\"name\":\"utm_matching_type\",\"type\":\"string\"},{\"name\":\"utm_source\",\"type\":\"string\"},{\"name\":\"utm_medium\",\"type\":\"string\"},{\"name\":\"utm_term\",\"type\":\"string\"},{\"name\":\"utm_content\",\"type\":\"string\"},{\"name\":\"utm_campaign\",\"type\":\"string\"}]}}]}},{\"name\":\"events\",\"type\":{\"type\":\"array\",\"name\":\"events_item\",\"items\":[{\"name\":\"click\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"long\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"time_since_last_operation\",\"type\":\"float\"},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info_record\",\"fields\":[{\"name\":\"user_id\",\"type\":\"string\"},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"latitude\",\"type\":\"string\"},{\"name\":\"longitude\",\"type\":\"string\"},{\"name\":\"province\",\"type\":\"string\"},{\"name\":\"city\",\"type\":\"string\"},{\"name\":\"country\",\"type\":\"string\"},{\"name\":\"province_id\",\"type\":\"string\"},{\"name\":\"city_id\",\"type\":\"string\"},{\"name\":\"county\",\"type\":\"string\"}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record\",\"fields\":[{\"name\":\"current_page_id\",\"type\":\"string\"},{\"name\":\"current_page_name\",\"type\":\"string\"},{\"name\":\"current_page_url\",\"type\":\"string\"},{\"name\":\"current_page_host\",\"type\":\"string\"},{\"name\":\"current_page_query\",\"type\":\"string\"},{\"name\":\"current_page_path\",\"type\":\"string\"},{\"name\":\"source_page_id\",\"type\":\"string\"},{\"name\":\"source_page_name\",\"type\":\"string\"},{\"name\":\"source_page_url\",\"type\":\"string\"},{\"name\":\"source_page_host\",\"type\":\"string\"},{\"name\":\"source_page_query\",\"type\":\"string\"},{\"name\":\"source_page_path\",\"type\":\"string\"}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"float\"]},{\"name\":\"page_Y\",\"type\":[\"null\",\"float\"]},{\"name\":\"client_X\",\"type\":[\"null\",\"float\"]},{\"name\":\"client_Y\",\"type\":[\"null\",\"float\"]}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"float\"]},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"float\"]},{\"name\":\"page_width\",\"type\":[\"null\",\"float\"]},{\"name\":\"page_height\",\"type\":[\"null\",\"float\"]}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record\",\"fields\":[{\"name\":\"element_id\",\"type\":\"string\"},{\"name\":\"element_name\",\"type\":\"string\"},{\"name\":\"element_target_url\",\"type\":\"string\"},{\"name\":\"element_type\",\"type\":\"string\"},{\"name\":\"element_content\",\"type\":\"string\"},{\"name\":\"element_selector\",\"type\":\"string\"},{\"name\":\"element_position\",\"type\":\"string\"},{\"name\":\"element_index\",\"type\":[\"int\",\"null\"]},{\"name\":\"element_tag_name\",\"type\":\"string\"},{\"name\":\"element_class\",\"type\":\"string\"},{\"name\":\"element_path\",\"type\":\"string\"}]}},{\"name\":\"event_code_md5\",\"type\":\"string\"}]},{\"type\":\"record\",\"name\":\"view_page\",\"fields\":[{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"long\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"time_since_last_operation\",\"type\":\"float\"},{\"name\":\"browse_time\",\"type\":\"string\"},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info_record2\",\"fields\":[{\"name\":\"user_id\",\"type\":\"string\"},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record_2\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"latitude\",\"type\":\"string\"},{\"name\":\"longitude\",\"type\":\"string\"},{\"name\":\"province\",\"type\":\"string\"},{\"name\":\"city\",\"type\":\"string\"},{\"name\":\"country\",\"type\":\"string\"},{\"name\":\"province_id\",\"type\":\"string\"},{\"name\":\"city_id\",\"type\":\"string\"},{\"name\":\"county\",\"type\":\"string\"}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record_2\",\"fields\":[{\"name\":\"current_page_id\",\"type\":\"string\"},{\"name\":\"current_page_name\",\"type\":\"string\"},{\"name\":\"current_page_url\",\"type\":\"string\"},{\"name\":\"current_page_host\",\"type\":\"string\"},{\"name\":\"current_page_query\",\"type\":\"string\"},{\"name\":\"current_page_path\",\"type\":\"string\"},{\"name\":\"source_page_id\",\"type\":\"string\"},{\"name\":\"source_page_name\",\"type\":\"string\"},{\"name\":\"source_page_url\",\"type\":\"string\"},{\"name\":\"source_page_host\",\"type\":\"string\"},{\"name\":\"source_page_query\",\"type\":\"string\"},{\"name\":\"source_page_path\",\"type\":\"string\"}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record_2\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"float\"]},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"float\"]}]}},{\"name\":\"event_code_md5\",\"type\":\"string\"}]},{\"type\":\"record\",\"name\":\"custom\",\"fields\":[{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"long\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"time_since_last_operation\",\"type\":\"float\"},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info_3\",\"fields\":[{\"name\":\"user_id\",\"type\":\"string\"},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record_3\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"latitude\",\"type\":\"string\"},{\"name\":\"longitude\",\"type\":\"string\"},{\"name\":\"province\",\"type\":\"string\"},{\"name\":\"city\",\"type\":\"string\"},{\"name\":\"country\",\"type\":\"string\"},{\"name\":\"province_id\",\"type\":\"string\"},{\"name\":\"city_id\",\"type\":\"string\"},{\"name\":\"county\",\"type\":\"string\"}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record_3\",\"fields\":[{\"name\":\"current_page_id\",\"type\":\"string\"},{\"name\":\"current_page_name\",\"type\":\"string\"},{\"name\":\"current_page_url\",\"type\":\"string\"},{\"name\":\"current_page_host\",\"type\":\"string\"},{\"name\":\"current_page_query\",\"type\":\"string\"},{\"name\":\"current_page_path\",\"type\":\"string\"},{\"name\":\"source_page_id\",\"type\":\"string\"},{\"name\":\"source_page_name\",\"type\":\"string\"},{\"name\":\"source_page_url\",\"type\":\"string\"},{\"name\":\"source_page_host\",\"type\":\"string\"},{\"name\":\"source_page_query\",\"type\":\"string\"},{\"name\":\"source_page_path\",\"type\":\"string\"}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record_3\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"float\"]},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"float\"]}]}},{\"name\":\"event_code_md5\",\"type\":\"string\"}]}]}}]},{\"type\":\"record\",\"name\":\"android\",\"namespace\":\"android\",\"fields\":[{\"name\":\"common\",\"type\":{\"name\":\"common_record\",\"type\":\"record\",\"fields\":[{\"name\":\"message_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"project_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"app_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"tenant_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"upload_time\",\"type\":\"long\"},{\"name\":\"Apex_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"session_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"app_version\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"app_package_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"carrier\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"mini_program_scene\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"sdk_info\",\"type\":{\"type\":\"record\",\"name\":\"sdk_info_record\",\"fields\":[{\"name\":\"sdk_version\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"sdk_type\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"device_info\",\"type\":{\"type\":\"record\",\"name\":\"device_info_record\",\"fields\":[{\"name\":\"device_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_model\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_brand\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"device_uuid\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"android_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"imei\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"mac\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"user_agent\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"idfa\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"idfv\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"oaid\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"screen\",\"type\":{\"type\":\"record\",\"name\":\"screen_record\",\"fields\":[{\"name\":\"screen_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"screen_width\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"os\",\"type\":{\"type\":\"record\",\"name\":\"os_record\",\"fields\":[{\"name\":\"os_system\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"os_version\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"browser\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"browser_record\",\"fields\":[{\"name\":\"browser_type\",\"type\":\"string\"},{\"name\":\"browser_version\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"wechat\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"wechat_record\",\"fields\":[{\"name\":\"wechat_open_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"wechat_union_id\",\"type\":[\"null\",\"string\"],\"default\":null}]}],\"default\":null},{\"name\":\"referrer_info\",\"type\":{\"type\":\"record\",\"name\":\"referrer_info_record\",\"fields\":[{\"name\":\"referrer_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"referrer_host\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"market_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_info\",\"type\":{\"type\":\"record\",\"name\":\"utm_info_record\",\"fields\":[{\"name\":\"utm_matching_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_source\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_medium\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_term\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"utm_campaign\",\"type\":[\"null\",\"string\"],\"default\":null}]}}]}},{\"name\":\"events\",\"type\":{\"type\":\"array\",\"name\":\"events_item\",\"items\":[{\"name\":\"click\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info1\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record1\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record1\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record1\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record1\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record1\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"view_page\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info2\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record2\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record2\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record2\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record2\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record2\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"custom\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info3\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record3\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record3\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record3\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record3\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record3\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"cold_start\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info4\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record4\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record4\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record4\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record4\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record4\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"hot_start\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info5\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record5\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record5\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record5\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record5\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record5\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"use_end\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_duration\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"event_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"send_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"ts\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"network_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"business_info\",\"type\":{\"type\":\"record\",\"name\":\"business_info6\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":{\"type\":\"map\",\"values\":\"string\"}}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record6\",\"fields\":[{\"name\":\"ip\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"latitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"longitude\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"country\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"province_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"city_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"county\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record6\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"coordinate_info\",\"type\":{\"type\":\"record\",\"name\":\"coordinate_info_record6\",\"fields\":[{\"name\":\"page_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_Y\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_X\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"client_Y\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"size_info\",\"type\":{\"type\":\"record\",\"name\":\"size_info_record6\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"visible_window_height\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_width\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"page_height\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"element_info\",\"type\":{\"type\":\"record\",\"name\":\"element_info_record6\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]}]}}]},{\"type\":\"record\",\"name\":\"ios\",\"namespace\":\"ios\",\"fields\":[{\"name\":\"common\",\"type\":{\"name\":\"common_record\",\"type\":\"record\",\"fields\":[{\"name\":\"message_id\",\"type\":\"string\"},{\"name\":\"project_id\",\"type\":\"string\"},{\"name\":\"app_id\",\"type\":\"string\"},{\"name\":\"tenant_id\",\"type\":\"string\"},{\"name\":\"upload_time\",\"type\":\"string\"},{\"name\":\"Apex_id\",\"type\":\"string\"},{\"name\":\"session_id\",\"type\":\"string\"},{\"name\":\"app_version\",\"type\":\"string\"},{\"name\":\"app_package_id\",\"type\":\"string\"},{\"name\":\"carrier\",\"type\":\"string\"},{\"name\":\"mini_program_scene\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"sdk_info\",\"type\":{\"type\":\"record\",\"name\":\"sdk_info_record\",\"fields\":[{\"name\":\"sdk_version\",\"type\":\"string\"},{\"name\":\"sdk_type\",\"type\":\"string\"}]}},{\"name\":\"device_info\",\"type\":{\"type\":\"record\",\"name\":\"device_info_record\",\"fields\":[{\"name\":\"device_id\",\"type\":\"string\"},{\"name\":\"device_model\",\"type\":\"string\"},{\"name\":\"device_brand\",\"type\":\"string\"},{\"name\":\"device_type\",\"type\":\"string\"},{\"name\":\"device_uuid\",\"type\":\"string\"},{\"name\":\"android_id\",\"type\":\"string\"},{\"name\":\"imei\",\"type\":\"string\"},{\"name\":\"mac\",\"type\":\"string\"},{\"name\":\"user_agent\",\"type\":\"string\"},{\"name\":\"idfa\",\"type\":\"string\"},{\"name\":\"idfv\",\"type\":\"string\"},{\"name\":\"oaid\",\"type\":\"string\"}]}},{\"name\":\"screen\",\"type\":{\"type\":\"record\",\"name\":\"screen_record\",\"fields\":[{\"name\":\"screen_height\",\"type\":\"string\"},{\"name\":\"screen_width\",\"type\":\"string\"}]}},{\"name\":\"os\",\"type\":{\"type\":\"record\",\"name\":\"os_record\",\"fields\":[{\"name\":\"os_system\",\"type\":\"string\"},{\"name\":\"os_version\",\"type\":\"string\"}]}},{\"name\":\"browser\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"browser_record\",\"fields\":[{\"name\":\"browser_type\",\"type\":\"string\"},{\"name\":\"browser_version\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"wechat\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"wechat_record\",\"fields\":[{\"name\":\"wechat_open_id\",\"type\":\"string\"},{\"name\":\"wechat_union_id\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"referrer_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"referrer_info_record\",\"fields\":[{\"name\":\"referrer_url\",\"type\":\"string\"},{\"name\":\"referrer_host\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"market_name\",\"type\":\"string\"},{\"name\":\"utm_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"utm_info_record\",\"fields\":[{\"name\":\"utm_matching_type\",\"type\":\"string\"},{\"name\":\"utm_source\",\"type\":\"string\"},{\"name\":\"utm_medium\",\"type\":\"string\"},{\"name\":\"utm_term\",\"type\":\"string\"},{\"name\":\"utm_content\",\"type\":\"string\"},{\"name\":\"utm_campaign\",\"type\":\"string\"}]}],\"default\":null}]}},{\"name\":\"events\",\"type\":{\"type\":\"array\",\"name\":\"events_item\",\"items\":[{\"name\":\"click\",\"type\":\"record\",\"fields\":[{\"name\":\"click\",\"type\":\"string\"},{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"string\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record6\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"}]}},{\"name\":\"business_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"business_info1\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":[\"null\",{\"type\":\"map\",\"values\":\"string\"}],\"default\":null}]}],\"default\":null},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record1\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":\"string\"},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":\"string\"}]}},{\"name\":\"coordinate_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"coordinate_info_record1\",\"fields\":[{\"name\":\"page_X\",\"type\":\"string\"},{\"name\":\"page_Y\",\"type\":\"string\"},{\"name\":\"client_X\",\"type\":\"string\"},{\"name\":\"client_Y\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"element_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"element_info_record1\",\"fields\":[{\"name\":\"element_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_target_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_type\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_content\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_selector\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_position\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_index\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_tag_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_class\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"element_path\",\"type\":[\"null\",\"string\"],\"default\":null}]}],\"default\":null},{\"name\":\"size_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"size_info_record1\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":\"string\"},{\"name\":\"visible_window_height\",\"type\":\"string\"},{\"name\":\"page_width\",\"type\":\"string\"},{\"name\":\"page_height\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"event_code_md5\",\"type\":\"string\"}]},{\"name\":\"view_page\",\"type\":\"record\",\"fields\":[{\"name\":\"view_page\",\"type\":\"string\"},{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"string\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":\"string\"},{\"name\":\"business_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"business_info2\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":[\"null\",{\"type\":\"map\",\"values\":\"string\"}],\"default\":null}]}],\"default\":null},{\"name\":\"page_info\",\"type\":{\"type\":\"record\",\"name\":\"page_info_record2\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":\"string\"},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":\"string\"}]}},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record1\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"}]}},{\"name\":\"coordinate_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"coordinate_info_record2\",\"fields\":[{\"name\":\"page_X\",\"type\":\"string\"},{\"name\":\"page_Y\",\"type\":\"string\"},{\"name\":\"client_X\",\"type\":\"string\"},{\"name\":\"client_Y\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"size_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"size_info_record2\",\"fields\":[{\"name\":\"visible_window_width\",\"type\":\"string\"},{\"name\":\"visible_window_height\",\"type\":\"string\"},{\"name\":\"page_width\",\"type\":\"string\"},{\"name\":\"page_height\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"event_code_md5\",\"type\":\"string\"}]},{\"name\":\"custom\",\"type\":\"record\",\"fields\":[{\"name\":\"custom\",\"type\":\"string\"},{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"string\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"time_since_last_operation\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"browse_time\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record5\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"}]}},{\"name\":\"business_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"business_info3\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":[\"null\",{\"type\":\"map\",\"values\":\"string\"}],\"default\":null}]}],\"default\":null},{\"name\":\"page_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"page_info_record3\",\"fields\":[{\"name\":\"current_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"current_page_path\",\"type\":\"string\"},{\"name\":\"source_page_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_name\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_url\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_host\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_query\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"source_page_path\",\"type\":\"string\"}]}],\"default\":null},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"cold_start\",\"type\":\"record\",\"fields\":[{\"name\":\"cold_start\",\"type\":\"string\"},{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"string\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record3\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"}]}},{\"name\":\"business_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"business_info4\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":[\"null\",{\"type\":\"map\",\"values\":\"string\"}],\"default\":null}]}],\"default\":null}]},{\"name\":\"hot_start\",\"type\":\"record\",\"fields\":[{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"hot_start\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"string\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record2\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"}]}},{\"name\":\"business_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"business_info5\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":[\"null\",{\"type\":\"map\",\"values\":\"string\"}],\"default\":null}]}],\"default\":null},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]},{\"name\":\"use_end\",\"type\":\"record\",\"fields\":[{\"name\":\"use_end\",\"type\":\"string\"},{\"name\":\"event_code\",\"type\":\"string\"},{\"name\":\"event_name\",\"type\":\"string\"},{\"name\":\"event_type\",\"type\":\"string\"},{\"name\":\"send_type\",\"type\":\"string\"},{\"name\":\"page_type\",\"type\":\"string\"},{\"name\":\"ts\",\"type\":\"string\"},{\"name\":\"network_type\",\"type\":\"string\"},{\"name\":\"event_duration\",\"type\":\"string\"},{\"name\":\"location_info\",\"type\":{\"type\":\"record\",\"name\":\"location_info_record4\",\"fields\":[{\"name\":\"ip\",\"type\":\"string\"}]}},{\"name\":\"business_info\",\"type\":[\"null\",{\"type\":\"record\",\"name\":\"business_info6\",\"fields\":[{\"name\":\"user_id\",\"type\":[\"null\",\"string\"],\"default\":null},{\"name\":\"extentions\",\"type\":[\"null\",{\"type\":\"map\",\"values\":\"string\"}],\"default\":null}]}],\"default\":null},{\"name\":\"event_code_md5\",\"type\":[\"null\",\"string\"],\"default\":null}]}]}}]}]}" ;
        String data_str = "[{\"ios.ios\":{\"common\":{\"message_id\":\"1\",\"project_id\":\"8ff7136b-d40a-4571-903e-bb2e4aefceeb\",\"app_id\":\"18e94303355ed4e7fe20f928cb663f99c7de0905\",\"tenant_id\":\"c65a02414ffc1f1e54f257cb5f27325b6f1d0cec\",\"upload_time\":\"1608523241750\",\"Apex_id\":\"57AAD570-D38B-46AF-91A2-3C6D70D2FAA7\",\"session_id\":\"session_1608523241749\",\"app_version\":\"1.0\",\"app_package_id\":\"com.apex.ApexDataTracker\",\"carrier\":\"(null)\",\"mini_program_scene\":null,\"sdk_info\":{\"sdk_version\":\"1.0.0\",\"sdk_type\":\"ios\"},\"device_info\":{\"device_id\":\"\",\"device_model\":\"iPhone 8\",\"device_brand\":\"iphone\",\"device_type\":\"phone\",\"device_uuid\":\"57AAD570-D38B-46AF-91A2-3C6D70D2FAA7\",\"android_id\":\"\",\"imei\":\"\",\"mac\":\"\",\"user_agent\":\"\",\"idfa\":\"E15AF7BF-EF16-4828-BA06-78CBA67B9874\",\"idfv\":\"42DF704A-8841-4F9F-87B7-696E97CD3083\",\"oaid\":\"\"},\"screen\":{\"screen_height\":\"667\",\"screen_width\":\"375\"},\"os\":{\"os_system\":\"ios\",\"os_version\":\"13.6.1\"},\"browser\":null,\"wechat\":null,\"referrer_info\":null,\"market_name\":\"App Store\",\"utm_info\":null},\"events\":[{\"ios.cold_start\":{\"cold_start\":\"1\",\"event_code\":\"cold_start\",\"event_name\":\"冷启动\",\"event_type\":\"cold_start\",\"send_type\":\"all\",\"page_type\":\"ios\",\"ts\":\"1608523241749\",\"network_type\":\"UNKNOW\",\"location_info\":{\"ip\":\"58.213.138.162\"},\"business_info\":null}}]}}]" ;

//
//
//
//System.out.println(Base64.getEncoder().encodeToString(jsonToAvroBin(schema_str, data_str))) ;


//        String push_response = Request.Post("https://apex-dc-push-test.chinapex.com.cn/buffer/bucket/dc/path/sdk_dev/avro_bulk_gzip")
//            .addHeader("Authorization", "Bearer " + access_token)
//            .addHeader("Content-Type", "application/octet-steam")
//
//            .bodyByteArray(gzip(jsonToAvroBin(schema_str, data_str)))
//            .execute()
//            .returnContent()
//            .asString();


    }
}
